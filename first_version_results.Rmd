---
title: "Results"
author: Zian ZHUANG
output:
  html_document:
    highlight: pygments
    toc: yes
    toc_float: yes
---

<!-- Setup -->
<style type="text/css">
body{ /* Normal  */
      font-size: 17px;
      font-family: "Times New Roman";
  }
h1,h2,h3,h4,h5,h6{
  font-family: "Times New Roman";
}
</style>
```{r setup, include = FALSE}
knitr::opts_chunk$set(echo = TRUE, cache = TRUE, cache.lazy = FALSE)
rm(list = ls())
library(tidyverse)
library(kableExtra)
```
<!-- Begin writing -->

## Goal

Build a SEIR model to investigate 4th dose vaccine protecting rate for different age group (0-59 and 60+), and compare it with 3rd and 2nd vaccine protecting rate.

## Model

### Assumption

`Homogeneous population`: All individuals in the same compartment is subject to the same hazards.

`Well-mixing population`: All susceptible have the same risk of getting infected.

`Birth`, `death` and `COVID mortality` is not considered yet.

### Equations

$$\begin{aligned}
\frac{dV_i}{dt}&=-\alpha_i V_i - (1 - \epsilon_i) * c * beta * I * V_i / N\\
\frac{dS}{dt}&= \sum_i \alpha_i * V_i - c * beta * I * S / N\\
\frac{dE}{dt}& = \sum_i (1 - \epsilon_i) * c * beta * I * V / N +
                   c * beta * I * S / N - \sigma * E\\
\frac{dI}{dt}& =  \sigma * E - \gamma * I  \\
\frac{dR}{dt}& =  \gamma * I
\end{aligned}$$

in which $c= \eta + (1 - \eta) / (1 + \exp(n_{week} - 5))$. $n_{week}$ means number of weeks since the 2021-12-05.

### Parameters

```{r,echo=FALSE}
table.par <- data.frame(Parameter=c("Population size",
                                    "Initial population with 2 dose vaccine only",
                                    "Initial population with 3 dose vaccine only",
                                    "Initial population (0 - 59 years) 
                                    with 4 dose vaccine",
                                    "Initial population (60 + years) 
                                    with 4 dose vaccine",
                                    "Initial susceptible group",
                                    "Initial exposed group",
                                    "Initial infectious group",
                                    "Initial recovered group",
                                    "immune waning rate",
                                    "First 2 dose immune protecting rate",
                                    "3 dose immune protecting rate",
                                    "4 dose immune protecting rate(0 - 59 years)",
                                    "4 dose immune protecting rate(60 + years)",
                                    "Transmission rate",
                                    "Government/public action",
                                    "Inverse latent period",
                                    "Inverse infectious period",
                                    "Dispersion parameter"),
                        Notation=c("N","V_1","V_2","V_3","V_4", 
                                   "S_0","E_0","I_0","R_0",
                                   "alpha","epsilon1","epsilon2",
                                   "epsilon3","epsilon4", "beta",
                                   "eta","sigma","gamma","phi"),
                        `Value_or_prior`=c(9217000,1691392,4065022,0,
                                           0,3460486,0,100,0,0.0001,
                                           "normal(0.3, 0.3)",
                                           "normal(0.6, 0.3)",
                                           "normal(0.7, 0.3)",
                                           "normal(0.7, 0.3)",
                                           "normal(0.5, 0.3)","beta(2, 4)",
                                           "normal(0.3, 0.3)","normal(0.5, 0.3)",
                                           "exp(0.6)"))
table.par %>%
  kbl(caption = "Summary table for parameters") %>%
  kable_classic(full_width = T, html_font = "Cambria")
```

Note that here we assume that 4 dose and 3 dose immune protecting rate is always higher than that of 3 dose and 2 dose, respectively.

### Data and Fitting

First Israeli Omicron COVID case was diagnosed on November 28. Considering it take few days for Omicron to be dominant variant in Israel, we collected the reported COVID case during 2021-12-5 and 2022- - from Israel ministry of health. In addition, we obtained weekly number of vaccinations (2nd, 3rd and 4th dose). We assumed that daily COVID cases are distributed with negative binomial distribution with a dispersion parameter $\phi$. Then we fit reported number of COVID cases to the model using Hamiltonian Monte Carlo (HMC) method. We ran 4 HMC chains with random initial values for a total number of 10,000 iterations per chain, discarding the first 5,000 iterations (burn-in). 

All data analyses were conducted using the R version 4.1.3 and Stan version . Datasets can be found at https://data.gov.il/dataset/covid-19 and codes used in this study can be found in the GitHub repository https://github.com/Larryzza/ms_report. 

## results

<div class="tocify-extend-page" data-unique="tocify-extend-page" style="height: 0;"></div>